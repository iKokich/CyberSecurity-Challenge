/* Переопределяем базовые стили body, чтобы игра встроилась в сайт */
body {
  background-color: #0c0c1d; /* Соответствует фону секций квиза */
  color: #d1d8e0; /* Основной цвет текста сайта */
  font-family: 'Montserrat', sans-serif; /* Основной шрифт сайта */
  line-height: 1.6;
  display: block; /* Сбрасываем flex, если был установлен по умолчанию */
  height: auto; /* Сбрасываем высоту, чтобы контент мог прокручиваться */
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* Обертка для центрирования игрового окна */
.game-wrapper {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: calc(100vh - 80px); /* Высота с учетом фиксированного навбара */
    padding: 100px 20px 40px; /* Отступы для адаптивности */
    box-sizing: border-box;
}

#game-window {
  position: relative;
  width: 900px;
  height: 600px;
  background: url('assets/img/game_bg_start.png') center/cover no-repeat;
  border: 3px solid #6c5ce7; /* Цвет рамки как у элементов сайта */
  border-radius: 20px; /* Закругление углов как у элементов сайта */
  overflow: hidden;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3); /* Тень как у элементов сайта */
  background-color: #1a1a3d; /* Fallback цвет для окна игры */
}

#overlay {
  position:absolute;
  inset:0;
  background:rgba(0,0,0,0.8); /* Темнее оверлей для модального эффекта */
  opacity:0;
  transition:opacity .6s ease;
  pointer-events:none;
  z-index:18;
}

/* Кнопка подсказки (наследует стили quiz-btn, но переопределяется здесь) */
#hint-btn.quiz-btn-game {
  position:absolute; top:15px; right:15px;
  z-index:20;
  background: #ffcc00; /* Цвет как у карточки мини-игры */
  color: #222; /* Темный текст на желтом фоне */
  border:none;
  padding:10px 20px;
  border-radius:30px;
  cursor:pointer; transition:background .3s;
  font-size:1.1rem;
  font-weight:600;
  display:flex;
  align-items:center;
  gap:10px;
  box-shadow: 0 3px 10px rgba(255, 204, 0, 0.3);
  width: fit-content; /* ИЗМЕНЕНИЕ: Жестко задаем ширину по содержимому */
  box-sizing: content-box; /* ИЗМЕНЕНИЕ: Чтобы padding не увеличивал общую ширину */
  white-space: nowrap; /* ИЗМЕНЕНИЕ: Предотвращает перенос текста */
}
#hint-btn.quiz-btn-game:hover { 
    background:#ffdb4d; 
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(255, 204, 0, 0.4);
}


#cat-container {
  position:absolute; bottom:250px; left:20px;
  display:flex; align-items:flex-end; gap:10px;
  opacity:0; transform:translateY(20px);
  transition:opacity .6s, transform .6s;
  z-index:19;
}
#cat-container.show {
  opacity:1; transform:translateY(0);
}
#cat-image {
  max-width:150px;
  border-radius:12px;
  box-shadow:0 0 20px rgba(0,0,0,0.35);
}
#cat-speech {
  background:#fff;
  color:#222;
  padding:15px 20px; border-radius:15px;
  max-width:400px; font-size:1.1rem; line-height:1.5;
  position:relative;
  border:1px solid rgba(255,255,255,0.1);
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}
#cat-speech::after {
  content:""; position:absolute;
  left:-15px; bottom:25px;
  border:12px solid transparent;
  border-right-color:#fff;
}

/* Кнопка "Далее" (наследует стили quiz-btn, но переопределяется здесь) */
#next-btn.next-btn-game {
  position:absolute; bottom:15px; right:15px;
  z-index:15;
  background:#6c5ce7;
  color:white;
  border:none;
  padding:15px 30px;
  border-radius:30px;
  cursor:pointer; transition:all .3s ease;
  font-size:1.1rem;
  font-weight:600;
  display:flex;
  align-items:center;
  gap:10px;
  width: fit-content; /* ИЗМЕНЕНИЕ: Жестко задаем ширину по содержимому */
  box-sizing: content-box; /* ИЗМЕНЕНИЕ: Чтобы padding не увеличивал общую ширину */
  white-space: nowrap; /* ИЗМЕНЕНИЕ: Предотвращает перенос текста */
}
#next-btn.next-btn-game:hover { 
    background:#5d4ae0; 
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(108, 92, 231, 0.4);
}

#scene-container {
  position:absolute; inset:0;
  background-size:cover; background-position:center;
  z-index:1;
}

#choice-box {
  position:absolute; left:0; bottom:-150px;
  width:100%; background:rgba(0,0,0,0.7);
  padding:20px; display:flex;
  justify-content:center; gap:15px;
  transition:bottom .45s ease;
  z-index:20;
  box-shadow: 0 -5px 20px rgba(0,0,0,0.3);
}
#choice-box.show { bottom:0; }

.choice-btn {
  background:#6c5ce7;
  color:white;
  border:none; padding:12px 25px;
  font-size:1.1rem; border-radius:30px;
  cursor:pointer;
  transition:background .25s, transform .05s;
  font-weight:600;
  white-space: nowrap; /* ИЗМЕНЕНИЕ: Предотвращает перенос текста */
}
.choice-btn:hover { 
    background:#5d4ae0; 
    transform:translateY(-2px); 
    box-shadow: 0 3px 8px rgba(108, 92, 231, 0.3);
}
.choice-btn:active { transform:translateY(1px); }

.hidden { display:none; }

/* Модальное окно пароля - стилизуем под модальные окна сайта */
#password-modal {
  position:fixed;
  top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.7);
  display:flex; align-items:center; justify-content:center;
  z-index:1001;
  opacity:0;
  transition:opacity .3s ease;
  pointer-events:none;
}
#password-modal.show {
  opacity:1; pointer-events:auto;
}
.modal-content {
  background:#1a1a3d;
  padding:30px;
  border-radius:20px;
  box-shadow:0 10px 30px rgba(0,0,0,0.5);
  display:flex; flex-direction:column; gap:15px;
  width:90%; max-width:400px;
  color:#d1d8e0;
}
.modal-content p {
  margin:0; font-size:1.1rem; color:#d1d8e0;
}
#modal-input {
  padding:12px; font-size:1rem;
  border:1px solid #4a4a6d;
  border-radius:8px;
  background:#0c0c1d;
  color:#d1d8e0;
  outline:none;
}
#modal-input::placeholder { color:#a5b1c2; }

#modal-error {
    color: #ff4757;
    font-size: 0.9rem;
    text-align: center;
    min-height: 1.5em;
}

.modal-buttons {
  display:flex; justify-content:flex-end; gap:10px;
  margin-top:10px;
}
.modal-buttons button {
  padding:10px 20px; font-size:1.1rem;
  border:none; border-radius:30px; cursor:pointer;
  font-weight:600;
  transition:all 0.3s ease;
  white-space: nowrap; /* ИЗМЕНЕНИЕ: Предотвращает перенос текста */
}
#modal-ok.cta-button {
  background: linear-gradient(45deg, #ff6b6b, #ff8e53);
  color: white;
  box-shadow: 0 3px 10px rgba(255, 107, 107, 0.3);
}
#modal-ok.cta-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(255, 107, 107, 0.5);
}
#modal-cancel.quiz-btn {
  background:#4a4a6d;
  color:white;
}
#modal-cancel.quiz-btn:hover {
  background:#5d4ae0;
  transform: translateY(-2px);
}

/* Responsive adjustments for game window */
@media (max-width: 992px) {
    .game-wrapper {
        min-height: calc(100vh - 60px);
        padding-top: 80px;
    }
    #game-window {
        width: 100%;
        max-width: 700px;
        height: 500px;
        border-radius: 15px;
    }
    #cat-container { bottom: 180px; }
    #cat-image { max-width: 120px; }
    #cat-speech { max-width: 300px; font-size: 1rem; padding: 12px 16px; }
    #cat-speech::after { left: -12px; bottom: 18px; border: 8px solid transparent; border-right-color: #fff; }
    #hint-btn.quiz-btn-game { padding: 8px 15px; font-size: 0.9rem; }
    #next-btn.next-btn-game { padding: 10px 20px; font-size: 1rem; }
    .choice-btn { padding: 10px 20px; font-size: 1rem; }
    #choice-box { padding: 12px; gap: 12px; }
    .modal-content { padding: 25px; gap: 12px; }
    .modal-buttons button { padding: 8px 15px; font-size: 1rem; }
}

@media (max-width: 768px) {
    .game-wrapper {
        padding-top: 70px;
        min-height: calc(100vh - 50px);
    }
    #game-window {
        height: 400px;
        border-width: 2px;
        border-radius: 12px;
    }
    #cat-container { bottom: 150px; left: 10px; }
    #cat-image { max-width: 100px; }
    #cat-speech { max-width: 250px; font-size: 0.9rem; padding: 10px 14px; }
    #cat-speech::after { left: -10px; bottom: 15px; border: 7px solid transparent; border-right-color: #fff; }
    #hint-btn.quiz-btn-game, #next-btn.next-btn-game { 
        padding: 8px 15px; font-size: 0.9rem; gap: 5px; 
        top: 10px; right: 10px;
        width: fit-content; /* ИЗМЕНЕНИЕ: Принудительно fit-content */
        box-sizing: content-box; /* ИЗМЕНЕНИЕ: Правильный box-sizing */
        white-space: nowrap; /* ИЗМЕНЕНИЕ: Предотвращает перенос текста */
    }
    #next-btn.next-btn-game { bottom: 10px; right: 10px; }
    .choice-btn { padding: 8px 15px; font-size: 0.9rem; border-radius: 25px; }
    #choice-box { padding: 10px; gap: 8px; flex-wrap: wrap; }
    .modal-content { padding: 20px; gap: 10px; }
    .modal-content p { font-size: 1rem; }
    #modal-input { padding: 6px; font-size: 0.9rem; }
    .modal-buttons button { padding: 6px 10px; font-size: 0.9rem; border-radius: 15px; }
}

@media (max-width: 480px) {
    .game-wrapper {
        padding-top: 60px;
    }
    #game-window {
        height: 300px;
        border-width: 1px;
        border-radius: 10px;
    }
    #cat-container { bottom: 100px; left: 5px; gap: 5px; }
    #cat-image { max-width: 80px; border-radius: 8px; }
    #cat-speech { max-width: 200px; font-size: 0.8rem; padding: 8px 10px; }
    #cat-speech::after { left: -8px; bottom: 10px; border: 5px solid transparent; border-right-color: #fff; }
    #hint-btn.quiz-btn-game, #next-btn.next-btn-game { 
        padding: 6px 10px; font-size: 0.8rem; gap: 3px; 
        top: 10px; right: 10px;
        width: fit-content; /* ИЗМЕНЕНИЕ: Принудительно fit-content */
        box-sizing: content-box; /* ИЗМЕНЕНИЕ: Правильный box-sizing */
        white-space: nowrap; /* ИЗМЕНЕНИЕ: Предотвращает перенос текста */
    }
    #next-btn.next-btn-game { bottom: 10px; right: 10px; }
    .choice-btn { padding: 6px 10px; font-size: 0.8rem; border-radius: 20px; }
    #choice-box { padding: 8px; gap: 6px; flex-wrap: wrap; }
    .modal-content { padding: 15px; gap: 8px; }
    .modal-content p { font-size: 0.9rem; }
    #modal-input { padding: 5px; font-size: 0.8rem; }
    .modal-buttons button { padding: 5px 8px; font-size: 0.8rem; border-radius: 15px; }
}